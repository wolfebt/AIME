<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF--8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI.me Pair Director</title>
    <meta name="author" content="Wolfe.bt@TangentLLC">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 1. Load React libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 2. Load Babel to transpile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 3. Load Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117;
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 25px 25px;
            color: #e6edf3;
        }

        .glass-panel {
            background-color: rgba(22, 27, 34, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(139, 148, 158, 0.2);
            border-radius: 0.75rem;
            animation: fadeIn 0.5s ease-out forwards;
        }

        .main-tab-btn {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            color: #8b949e;
            transition: all 0.2s;
        }
        .main-tab-btn.active {
            color: #2563eb; /* Dark Blue */
            border-bottom-color: #2563eb; /* Dark Blue */
        }
        .main-tab-btn:not(.active):hover {
            color: #c9d1d9;
            border-bottom-color: rgba(139, 148, 158, 0.3);
        }
        .nav-btn-side {
            display: block;
            width: 100%;
            text-align: left;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: background-color 0.2s, color 0.2s;
            color: #8b949e;
        }
        .nav-btn-side.active {
            background-color: rgba(30, 58, 138, 0.1);
            color: #2563eb; /* Dark Blue */
        }
        .nav-btn-side:not(.active):hover {
            background-color: rgba(139, 148, 158, 0.1);
            color: #c9d1d9;
        }
        
        .btn-primary {
            background-color: #4c1d95; /* Dark Purple */
            color: white;
            border: 1px solid #2563eb; /* Thin Blue Border */
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(76, 29, 149, 0.4);
            font-weight: 600;
        }
        .btn-primary:hover:not(:disabled) { 
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(76, 29, 149, 0.6);
            background-color: #5b21b6; /* Lighter purple on hover */
            border-color: #3b82f6; /* Brighter blue on hover */
        }

        .btn-secondary {
            background-color: rgba(139, 148, 158, 0.15);
            color: #c9d1d9;
            transition: background-color 0.3s;
            border: 1px solid rgba(139, 148, 158, 0.2);
        }
        .btn-secondary:hover:not(:disabled) { 
            background-color: rgba(139, 148, 158, 0.3);
            border-color: rgba(139, 148, 158, 0.4);
        }
        .editable-title {
            outline: none;
            border-bottom: 1px solid #2563eb; /* Thin blue bottom border */
            color: #4c1d95; /* Dark purple text */
            transition: border-color 0.3s;
            padding: 0.1rem 0.25rem;
        }
        .editable-title:focus {
            border-bottom-color: #3b82f6; /* Brighter blue on focus */
        }
        .asset-card {
            background-color: rgba(139, 148, 158, 0.1);
            border: 1px solid rgba(139, 148, 158, 0.2);
            transition: all 0.2s;
        }
        .asset-card:hover {
            border-color: #2563eb; /* Dark Blue */
            background-color: rgba(37, 99, 235, 0.1);
        }
        .switch { position: relative; display: inline-block; width: 34px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #30363d; transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: #e6edf3; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #1e3a8a; } /* Dark Blue */
        input:checked + .slider:before { transform: translateX(14px); }
        
        /* Accordion Styles */
        .accordion-section {
            background-color: rgba(36, 41, 47, 0.7);
            border: 1px solid rgba(139, 148, 158, 0.2);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .accordion-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            font-weight: 600;
            color: #e6edf3;
            background-color: rgba(139, 148, 158, 0.1);
            cursor: pointer;
        }
        .accordion-section.open .accordion-header span {
            color: #2563eb; /* Dark Blue */
        }
        .accordion-header svg { 
            transition: transform 0.2s;
            color: #a78bfa;
        }
        .accordion-section.open .accordion-header svg { transform: rotate(180deg); }
        .accordion-content { padding: 1.5rem; }

        /* Input Field Styles */
        .tool-input {
            background-color: #0d1117;
            border: 1px solid #30363d;
            color: #e6edf3;
            width: 100%;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            transition: all 0.2s ease;
            min-height: 52px; /* Uniform height for all fields */
        }
        .tool-input:focus {
            outline: none;
            border-color: #1e3a8a; /* Dark Blue */
            box-shadow: 0 0 10px rgba(30, 58, 138, 0.3);
        }
        .tool-input::placeholder { color: #484f58; }
        
        .action-btn {
            background-color: rgba(139, 148, 158, 0.1);
            color: #8b949e;
            transition: all 0.2s;
        }
        .action-btn:hover {
            background-color: rgba(139, 148, 158, 0.2);
            color: #c9d1d9;
        }
        
        @keyframes colorCycle {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes glowPulse {
            0%, 100% { filter: blur(10px); opacity: 0; }
            12.5% { filter: blur(12px); opacity: 0.3; }
            25% { filter: blur(15px); opacity: 0.6; }
            37.5% { filter: blur(20px); opacity: 0.9; }
            50% { filter: blur(25px); opacity: 1; }
            62.5% { filter: blur(20px); opacity: 0.9; }
            75% { filter: blur(15px); opacity: 0.6; }
            87.5% { filter: blur(12px); opacity: 0.3; }
        }
        .title-animated-gradient {
            position: relative;
            background: linear-gradient(90deg, #3b0764, #5b21b6, #1e3a8a, #1e293b, #1e3a8a, #5b21b6, #3b0764);
            background-size: 400% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: colorCycle 10s ease infinite;
        }
        .title-animated-gradient::before {
            content: attr(data-text);
            position: absolute;
            left: 0;
            top: 0;
            z-index: -1;
            background: linear-gradient(90deg, #3b0764, #5b21b6, #1e3a8a, #1e293b, #1e3a8a, #5b21b6, #3b0764);
            background-size: 400% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: colorCycle 10s ease infinite, glowPulse 6s ease-in-out infinite;
        }
        .resize-handle {
            width: 12px;
            cursor: col-resize;
            background-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
         .resize-handle:hover, .resize-handle.resizing {
             background-color: rgba(37, 99, 235, 0.2);
         }
        .resize-handle::before {
            content: 'â‹®';
            color: #484f58;
            font-size: 20px;
            line-height: 1;
            transform: rotate(90deg);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Custom Hooks ---
        function useOnClickOutside(ref, handler) {
            useEffect(() => {
                const listener = (event) => {
                    if (!ref.current || ref.current.contains(event.target)) {
                        return;
                    }
                    handler(event);
                };
                document.addEventListener("mousedown", listener);
                document.addEventListener("touchstart", listener);
                return () => {
                    document.removeEventListener("mousedown", listener);
                    document.removeEventListener("touchstart", listener);
                };
            }, [ref, handler]);
        }

        // --- Resizable Columns Component ---
        const ResizableColumns = ({ leftColumn, rightColumn, initialLeftWidth = 33.33 }) => {
            const [leftWidth, setLeftWidth] = useState(initialLeftWidth);
            const [isResizing, setIsResizing] = useState(false);
            const containerRef = useRef(null);

            const handleMouseDown = (e) => {
                e.preventDefault();
                setIsResizing(true);
            };

            const handleMouseUp = () => {
                setIsResizing(false);
            };

            const handleMouseMove = (e) => {
                if (!isResizing || !containerRef.current) return;

                const containerRect = containerRef.current.getBoundingClientRect();
                const newLeftWidthPx = e.clientX - containerRect.left;
                let newLeftWidthPercent = (newLeftWidthPx / containerRect.width) * 100;
                
                newLeftWidthPercent = Math.max(20, Math.min(80, newLeftWidthPercent));

                setLeftWidth(newLeftWidthPercent);
            };

            useEffect(() => {
                if (isResizing) {
                    window.addEventListener('mousemove', handleMouseMove);
                    window.addEventListener('mouseup', handleMouseUp);
                } else {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                }

                return () => {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                };
            }, [isResizing, handleMouseMove, handleMouseUp]);


            return (
                <div ref={containerRef} className="flex w-full h-full">
                    <div style={{ width: `${leftWidth}%` }}>
                        {leftColumn}
                    </div>
                    <div
                        className={`resize-handle ${isResizing ? 'resizing' : ''}`}
                        onMouseDown={handleMouseDown}
                    >
                    </div>
                    <div style={{ width: `${100 - leftWidth}%`, paddingLeft: '2rem' }}>
                         {rightColumn}
                    </div>
                </div>
            );
        };

        // --- Reusable SVG Icon Components ---
        const SettingsIcon = () => ( <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0l-.1.41a2 2 0 01-2.23 1.52l-.4-.1a2 2 0 00-2.2 2.2l.1.4a2 2 0 01-1.52 2.23l-.41.1c-1.56.38-1.56 2.6 0 2.98l.41.1a2 2 0 011.52 2.23l-.1.4a2 2 0 002.2 2.2l.4-.1a2 2 0 012.23 1.52l.1.41c.38 1.56 2.6 1.56 2.98 0l.1-.41a2 2 0 012.23-1.52l.4.1a2 2 0 002.2-2.2l-.1-.4a2 2 0 011.52-2.23l.41-.1c-1.56-.38-1.56-2.6 0-2.98l-.41-.1a2 2 0 01-1.52-2.23l.1-.4a2 2 0 00-2.2-2.2l-.4.1a2 2 0 01-2.23-1.52l-.1-.41zM10 13a3 3 0 100-6 3 3 0 000 6z" clipRule="evenodd" /></svg> );
        const FileIcon = () => ( <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 0v12h8V4H6z" clipRule="evenodd" /></svg> );
        const ImageIcon = () => ( <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clipRule="evenodd" /></svg> );
        const ChevronDownIcon = () => ( <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M19 9l-7 7-7-7"></path></svg> );
        const FileActionIcon = () => (<svg className="w-5 h-5" viewBox="0 0 20 20" fill="currentColor"><path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" /></svg>);
        const CloseIcon = () => (<svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" /></svg>);
        const PrintIcon = () => ( <svg className="w-5 h-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v6a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clipRule="evenodd" /></svg>);

        // --- Reusable UI Components ---
        const AccordionSection = ({ title, startOpen = false, children, titleClassName="", isOpen: controlledIsOpen, onToggle: controlledOnToggle }) => {
            const [internalIsOpen, setInternalIsOpen] = useState(startOpen);
            const isControlled = controlledIsOpen !== undefined;
            const isOpen = isControlled ? controlledIsOpen : internalIsOpen;
            const onToggle = isControlled ? controlledOnToggle : () => setInternalIsOpen(!internalIsOpen);

            return (
                <div className={`accordion-section ${isOpen ? 'open' : ''}`}>
                    <button type="button" className="accordion-header" onClick={onToggle}>
                        <span className={titleClassName}>{title}</span>
                        <ChevronDownIcon />
                    </button>
                    {isOpen && ( <div className="accordion-content">{children}</div>)}
                </div>
            );
        };

        const DropdownSelector = ({ title, options, selectedOption, onSelect, customValue, onCustomChange, customPlaceholder }) => {
            const isCustom = !options.includes(selectedOption);
            const handleSelectChange = (e) => onSelect(e.target.value);

            return (
                <div>
                    <label className="block text-sm font-medium text-gray-300 mb-1">{title}</label>
                    <select
                        value={isCustom ? 'Other...' : selectedOption}
                        onChange={handleSelectChange}
                        className="tool-input !min-h-0 py-2 w-full bg-[#0d1117]"
                    >
                        {options.map(option => ( <option key={option} value={option}>{option}</option>))}
                         <option value="Other...">Other...</option>
                    </select>
                    {isCustom && (
                        <input
                            type="text"
                            value={customValue}
                            onChange={onCustomChange}
                            className="tool-input !min-h-0 py-2 mt-2"
                            placeholder={customPlaceholder || "Enter custom value..."}
                        />
                    )}
                </div>
            );
        };
        
        const EditableTitleWithFileAction = ({ title, setTitle, contentType, contentData }) => {
            const [isModalOpen, setIsModalOpen] = useState(false);
            return (
                <>
                    <div className="flex items-center gap-4">
                        <h3 
                            contentEditable="true"
                            suppressContentEditableWarning={true}
                            onInput={e => setTitle(e.currentTarget.textContent)}
                            className="editable-title text-2xl font-bold p-1 rounded-md hover:bg-gray-700/50 cursor-pointer inline-block"
                        >{title}</h3>
                        <div className="flex items-center gap-2">
                            <button onClick={() => setIsModalOpen(true)} className="action-btn p-2 rounded-md" title="File Actions"><FileActionIcon /></button>
                        </div>
                    </div>
                </>
            );
        };

        const AssetManager = ({ title }) => { 
            const [assets, setAssets] = useState([]);
            return ( 
                <AccordionSection title={title} titleClassName="text-xl font-bold">
                    <button className="w-full py-2 px-4 rounded-lg font-semibold btn-secondary mb-4">Load Asset(s)</button>
                    <div className="space-y-2">
                        {assets.map(asset => ( 
                            <div key={asset.id} className="asset-card flex items-center justify-between p-2 rounded-md">
                                <div className="flex items-center gap-2">
                                    {asset.type === 'image' ? <ImageIcon /> : <FileIcon />}
                                    <span className="text-sm text-gray-300">{asset.name}</span>
                                </div>
                                <label className="switch">
                                    <input type="checkbox" checked={asset.included} onChange={() => {}} />
                                    <span className="slider"></span>
                                </label>
                            </div>
                        ))}
                    </div>
                </AccordionSection> 
            );
        };

        // --- Main App Component ---
        function App() {
            const [activeMainTab, setActiveMainTab] = useState('video');
            const [notification, setNotification] = useState(null);
            const clearNotification = () => setNotification(null);

            const Notification = ({ notification, onClear }) => {
                useEffect(() => {
                    if (notification) {
                        const timer = setTimeout(() => onClear(), 5000);
                        return () => clearTimeout(timer);
                    }
                }, [notification, onClear]);

                if (!notification) return null;
                const bgColor = notification.type === 'error' ? 'bg-red-500/20 border-red-500/50' : 'bg-blue-800/20 border-blue-700/50';
                const textColor = notification.type === 'error' ? 'text-red-400' : 'text-blue-300';

                return (
                    <div className={`fixed bottom-8 right-8 glass-panel p-4 rounded-lg flex items-center gap-4 z-50 ${bgColor}`} style={{animation: 'slideInUp 0.5s ease-out forwards'}}>
                        <p className={`font-semibold ${textColor}`}>{notification.message}</p>
                        <button onClick={onClear} className="text-gray-400 hover:text-white"><CloseIcon /></button>
                    </div>
                );
            };

            const Header = () => ( 
                <header className="text-center mb-4 relative pt-4">
                    <h1 className="inline-block text-5xl font-black tracking-wide title-animated-gradient" data-text="AI.me Pair Director">AI.me Pair Director</h1>
                    <button className="absolute top-4 right-0 p-2 rounded-lg btn-secondary" title="Settings"><SettingsIcon /></button>
                </header> 
            );

            const MainTabs = ({ activeTab, setActiveTab }) => (
                <div className="border-b border-gray-700">
                    <nav className="-mb-px flex space-x-6 justify-center" aria-label="Tabs">
                        <button onClick={() => setActiveTab('video')} className={`main-tab-btn ${activeTab === 'video' ? 'active' : ''}`}>Video</button>
                        <button onClick={() => setActiveTab('audio')} className={`main-tab-btn ${activeTab === 'audio' ? 'active' : ''}`}>Audio</button>
                    </nav>
                </div> 
            );

            const VideoVisuals = () => {
                const [title, setTitle] = useState('Untitled Video Project');
                const [prompt, setPrompt] = useState('');
                
                const [mediaBin, setMediaBin] = useState([
                    { id: 1, type: 'video', name: 'Opening Shot', url: 'https://videos.pexels.com/video-files/3209828/3209828-sd_640_360_30fps.mp4', duration: 5 },
                    { id: 2, type: 'video', name: 'Action Sequence', url: 'https://videos.pexels.com/video-files/853887/853887-sd_640_360_25fps.mp4', duration: 8 },
                    { id: 3, type: 'audio', name: 'Main Theme', url: 'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', duration: 3 }
                ]);
                const [timeline, setTimeline] = useState({
                    video: [ { clipId: 1, start: 0, end: 5 }, { clipId: 2, start: 5, end: 13 } ],
                    audio: [ { clipId: 3, start: 2, end: 5 } ]
                });
                const [previewUrl, setPreviewUrl] = useState(mediaBin[0]?.url);
                 const [editingTools, setEditingTools] = useState({
                    transitionType: 'None',
                    transitionDuration: 1,
                    filter: 'None',
                    textOverlay: ''
                });

                const handleEditToolChange = (tool, value) => {
                    setEditingTools(prev => ({ ...prev, [tool]: value }));
                };

                const transitionOptions = ['None', 'Cross Fade', 'Wipe Left', 'Wipe Right', 'Push Up'];
                const filterOptions = ['None', 'Black & White', 'Sepia', 'Vintage', 'Technicolor', 'Invert'];

                const handleGenerateClip = () => {
                    const newId = mediaBin.length + 1;
                    const newClip = {
                        id: newId,
                        type: 'video',
                        name: prompt.substring(0, 20) || `Clip ${newId}`,
                        url: 'https://videos.pexels.com/video-files/1578311/1578311-sd_640_360_24fps.mp4',
                        duration: 7
                    };
                    setMediaBin(prev => [...prev, newClip]);
                };

                const MediaBin = () => (
                    <div className="space-y-4">
                         <AccordionSection title="Media Bin" startOpen={true} titleClassName="text-xl font-bold">
                            <div className="grid grid-cols-2 gap-2 p-2 bg-gray-900/50 rounded-md max-h-96 overflow-y-auto">
                                {mediaBin.map(clip => (
                                    <div key={clip.id} className="relative aspect-video bg-black rounded cursor-pointer group">
                                        {clip.type === 'video' ? 
                                            <video src={clip.url} className="w-full h-full object-cover rounded" muted /> :
                                            <div className="w-full h-full flex items-center justify-center bg-gray-700 rounded text-purple-400">Audio Clip</div>
                                        }
                                        <div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                            <p className="text-white text-xs text-center font-semibold p-1">{clip.name}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </AccordionSection>
                    </div>
                );

                const Timeline = () => {
                    const totalDuration = timeline.video.reduce((max, clip) => Math.max(max, clip.end), 0);
                    return (
                        <div>
                             <h2 className="text-xl font-bold mb-4 text-blue-500">Timeline</h2>
                             <div className="glass-panel p-4 space-y-2">
                                <div className="bg-gray-900/50 rounded h-16 relative flex items-center px-2">
                                    <span className="text-xs font-bold text-blue-400 absolute left-2 top-1">VIDEO</span>
                                    {timeline.video.map(item => {
                                        const clip = mediaBin.find(c => c.id === item.clipId);
                                        if (!clip) return null;
                                        const width = ((item.end - item.start) / totalDuration) * 100;
                                        const left = (item.start / totalDuration) * 100;
                                        return <div key={item.clipId} style={{ left: `${left}%`, width: `${width}%`}} className="absolute h-10 bg-blue-800 rounded flex items-center justify-center text-white text-xs font-semibold overflow-hidden">{clip.name}</div>
                                    })}
                                </div>
                                <div className="bg-gray-900/50 rounded h-16 relative flex items-center px-2">
                                     <span className="text-xs font-bold text-purple-400 absolute left-2 top-1">AUDIO</span>
                                    {timeline.audio.map(item => {
                                        const clip = mediaBin.find(c => c.id === item.clipId);
                                        if (!clip) return null;
                                        const width = ((item.end - item.start) / totalDuration) * 100;
                                        const left = (item.start / totalDuration) * 100;
                                        return <div key={item.clipId} style={{ left: `${left}%`, width: `${width}%`}} className="absolute h-10 bg-purple-800 rounded flex items-center justify-center text-white text-xs font-semibold overflow-hidden">{clip.name}</div>
                                    })}
                                </div>
                             </div>
                        </div>
                    );
                };

                return (
                    <ResizableColumns
                        leftColumn={
                            <div className="space-y-8">
                                 <div>
                                    <h2 className="text-xl font-bold mb-4 text-blue-500">Preview</h2>
                                    <div className="w-full aspect-video bg-gray-900 rounded-md flex items-center justify-center border border-gray-700">
                                        {previewUrl ? (
                                            <video src={previewUrl} controls autoPlay loop muted className="w-full h-full object-cover rounded-md" />
                                         ) : (
                                            <span className="text-gray-500">Your generated video will appear here.</span>
                                         )}
                                    </div>
                                </div>
                                <Timeline />
                                 <AccordionSection title="Editing Tools" titleClassName="text-xl font-bold">
                                    <div className="space-y-6">
                                        <div>
                                            <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Trimming & Splicing</h4>
                                            <div className="space-y-2">
                                                <button className="btn-secondary w-full py-2 text-sm rounded-md">Split Clip at Playhead</button>
                                                <p className="text-xs text-gray-500 text-center">Select a clip in the timeline first.</p>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Transitions</h4>
                                            <div className="space-y-4">
                                                <DropdownSelector
                                                    title="Transition Type"
                                                    options={transitionOptions}
                                                    selectedOption={editingTools.transitionType}
                                                    onSelect={(val) => handleEditToolChange('transitionType', val)}
                                                />
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-300 mb-1">Duration (seconds)</label>
                                                    <input 
                                                        type="number" 
                                                        value={editingTools.transitionDuration}
                                                        onChange={(e) => handleEditToolChange('transitionDuration', e.target.value)}
                                                        step="0.1" 
                                                        className="tool-input !min-h-0 py-2" 
                                                    />
                                                </div>
                                                <button className="btn-secondary w-full py-2 text-sm rounded-md">Apply to Selected Cut</button>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Effects & Filters</h4>
                                            <div className="space-y-4">
                                                <DropdownSelector
                                                    title="Filter"
                                                    options={filterOptions}
                                                    selectedOption={editingTools.filter}
                                                    onSelect={(val) => handleEditToolChange('filter', val)}
                                                />
                                                <button className="btn-secondary w-full py-2 text-sm rounded-md">Apply to Selected Clip</button>
                                            </div>
                                        </div>
                                        <div>
                                            <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Text Overlays</h4>
                                            <div className="space-y-4">
                                                <div>
                                                    <label className="block text-sm font-medium text-gray-300 mb-1">Text Content</label>
                                                    <textarea 
                                                        className="tool-input" 
                                                        rows="3" 
                                                        placeholder="Enter text to display..."
                                                        value={editingTools.textOverlay}
                                                        onChange={(e) => handleEditToolChange('textOverlay', e.target.value)}
                                                    ></textarea>
                                                </div>
                                                <button className="btn-primary w-full py-2 text-sm rounded-md">Add Text Overlay</button>
                                            </div>
                                        </div>
                                    </div>
                                </AccordionSection>
                            </div>
                        }
                        rightColumn={
                             <div className="space-y-8">
                                <EditableTitleWithFileAction title={title} setTitle={setTitle} contentType="video" contentData={{}} />
                                
                                 <AccordionSection title="Clip Generation" startOpen={true} titleClassName="text-xl font-bold">
                                    <div className="space-y-4">
                                        <textarea value={prompt} onChange={e => setPrompt(e.target.value)} placeholder="e.g., An epic cinematic drone shot of a medieval castle..." className="tool-input w-full" rows="4" />
                                        <button onClick={handleGenerateClip} className="btn-primary w-full py-2 rounded-md font-semibold">Generate Clip</button>
                                    </div>
                                </AccordionSection>

                                <MediaBin />

                                <AssetManager title="Video Project Assets" />
                            </div>
                        }
                    />
                );
            };

            const AudioView = ({ setNotification }) => {
                const [title, setTitle] = useState('Untitled Audio Project');
                const [prompt, setPrompt] = useState('');
                const [mediaBin, setMediaBin] = useState([
                    { id: 1, type: 'narration', name: 'Opening Narration', url: 'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', duration: 3 },
                    { id: 2, type: 'music', name: 'Main Theme', url: '#', duration: 15 },
                    { id: 3, type: 'sfx', name: 'Explosion', url: '#', duration: 2 }
                ]);
                const [timeline, setTimeline] = useState({
                    narration: [{ clipId: 1, start: 1, end: 4 }],
                    music: [{ clipId: 2, start: 0, end: 15 }],
                    sfx: [{ clipId: 3, start: 7, end: 9 }]
                });
                const [previewUrl, setPreviewUrl] = useState(mediaBin[0]?.url);
                 const [editingTools, setEditingTools] = useState({
                    fadeType: 'Fade In',
                    fadeDuration: 1,
                    effectType: 'None',
                    effectAmount: 50
                });

                const handleEditToolChange = (tool, value) => {
                    setEditingTools(prev => ({ ...prev, [tool]: value }));
                };

                const fadeOptions = ['Fade In', 'Fade Out', 'Crossfade'];
                const effectOptions = ['None', 'Reverb', 'Echo', 'Pitch Shift (Up)', 'Pitch Shift (Down)'];

                const handleGenerate = () => {
                    const newId = mediaBin.length + 1;
                    const newClip = {
                        id: newId,
                        type: 'narration',
                        name: prompt.substring(0, 20) || `Clip ${newId}`,
                        url: 'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3',
                        duration: 3
                    };
                    setMediaBin(prev => [...prev, newClip]);
                };

                const MediaBin = () => (
                     <AccordionSection title="Media Bin" startOpen={true} titleClassName="text-xl font-bold">
                        <div className="grid grid-cols-2 gap-2 p-2 bg-gray-900/50 rounded-md max-h-96 overflow-y-auto">
                            {mediaBin.map(clip => (
                                <div key={clip.id} className="relative p-2 bg-gray-700 rounded cursor-pointer group">
                                    <p className="text-white text-xs text-center font-semibold truncate">{clip.name}</p>
                                    <p className="text-purple-400 text-xs text-center font-mono">{clip.type}</p>
                                </div>
                            ))}
                        </div>
                    </AccordionSection>
                );

                const Timeline = () => {
                    const totalDuration = Object.values(timeline).flat().reduce((max, clip) => Math.max(max, clip.end), 15);
                     const tracks = [
                        { name: 'NARRATION', data: timeline.narration, color: 'bg-green-800' },
                        { name: 'MUSIC', data: timeline.music, color: 'bg-blue-800' },
                        { name: 'SFX', data: timeline.sfx, color: 'bg-yellow-800' },
                    ];
                    return (
                        <div>
                             <h2 className="text-xl font-bold mb-4 text-blue-500">Timeline</h2>
                             <div className="glass-panel p-4 space-y-2">
                                {tracks.map(track => (
                                    <div key={track.name} className="bg-gray-900/50 rounded h-16 relative flex items-center px-2">
                                        <span className="text-xs font-bold text-gray-400 absolute left-2 top-1">{track.name}</span>
                                        {track.data.map(item => {
                                            const clip = mediaBin.find(c => c.id === item.clipId);
                                            if (!clip) return null;
                                            const width = ((item.end - item.start) / totalDuration) * 100;
                                            const left = (item.start / totalDuration) * 100;
                                            return <div key={item.clipId} style={{ left: `${left}%`, width: `${width}%`}} className={`absolute h-10 ${track.color} rounded flex items-center justify-center text-white text-xs font-semibold overflow-hidden`}>{clip.name}</div>
                                        })}
                                    </div>
                                ))}
                             </div>
                        </div>
                    );
                };

                return (
                    <div className="glass-panel p-6">
                        <ResizableColumns
                            leftColumn={
                                <div className="space-y-8">
                                    <div>
                                        <h2 className="text-xl font-bold mb-4 text-blue-500">Preview</h2>
                                        <div className="w-full bg-gray-900 rounded-md flex items-center justify-center border border-gray-700 p-4">
                                            {previewUrl ? (
                                                <audio src={previewUrl} controls className="w-full" />
                                            ) : (
                                                <span className="text-gray-500">Your generated audio will appear here.</span>
                                            )}
                                        </div>
                                    </div>
                                    <Timeline />
                                    <AccordionSection title="Editing Tools" titleClassName="text-xl font-bold">
                                        <div className="space-y-6">
                                            <div>
                                                <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Trimming & Splicing</h4>
                                                <div className="space-y-2">
                                                    <button className="btn-secondary w-full py-2 text-sm rounded-md">Split Clip at Playhead</button>
                                                    <p className="text-xs text-gray-500 text-center">Select a clip in the timeline first.</p>
                                                </div>
                                            </div>
                                            <div>
                                                <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Fades & Transitions</h4>
                                                <div className="space-y-4">
                                                    <DropdownSelector
                                                        title="Fade Type"
                                                        options={fadeOptions}
                                                        selectedOption={editingTools.fadeType}
                                                        onSelect={(val) => handleEditToolChange('fadeType', val)}
                                                    />
                                                    <div>
                                                        <label className="block text-sm font-medium text-gray-300 mb-1">Duration (seconds)</label>
                                                        <input 
                                                            type="number" 
                                                            value={editingTools.fadeDuration}
                                                            onChange={(e) => handleEditToolChange('fadeDuration', e.target.value)}
                                                            step="0.1" 
                                                            className="tool-input !min-h-0 py-2" 
                                                        />
                                                    </div>
                                                    <button className="btn-secondary w-full py-2 text-sm rounded-md">Apply to Selected Clip</button>
                                                </div>
                                            </div>
                                            <div>
                                                <h4 className="font-semibold text-lg text-blue-500 border-b border-gray-700 pb-2 mb-4">Audio Effects</h4>
                                                <div className="space-y-4">
                                                    <DropdownSelector
                                                        title="Effect Type"
                                                        options={effectOptions}
                                                        selectedOption={editingTools.effectType}
                                                        onSelect={(val) => handleEditToolChange('effectType', val)}
                                                    />
                                                    <div>
                                                        <label className="block text-sm font-medium text-gray-300 mb-1">Amount / Intensity</label>
                                                        <input 
                                                            type="range"
                                                            min="0"
                                                            max="100"
                                                            value={editingTools.effectAmount}
                                                            onChange={(e) => handleEditToolChange('effectAmount', e.target.value)}
                                                            className="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"
                                                        />
                                                    </div>
                                                    <button className="btn-secondary w-full py-2 text-sm rounded-md">Apply to Selected Clip</button>
                                                </div>
                                            </div>
                                        </div>
                                    </AccordionSection>
                                </div>
                            }
                            rightColumn={
                                <div className="space-y-8">
                                    <EditableTitleWithFileAction title={title} setTitle={setTitle} contentType="audio" contentData={{}} />
                                    
                                    <AccordionSection title="Audio Generation" startOpen={true} titleClassName="text-xl font-bold">
                                         <div className="space-y-6">
                                            <p className="text-sm text-gray-400">Generate narration, music, or sound effects to add to your Media Bin.</p>
                                            <textarea value={prompt} onChange={e => setPrompt(e.target.value)} placeholder="e.g., An epic orchestral score..." className="tool-input w-full" rows="4" />
                                            <button onClick={handleGenerate} className="btn-primary w-full py-2 rounded-md font-semibold">Generate Clip</button>
                                        </div>
                                    </AccordionSection>
                                    
                                    <MediaBin />
                                    
                                    <AssetManager title="Audio Project Assets" />
                                </div>
                            }
                        />
                    </div>
                );
            };

            const Footer = () => ( <footer className="text-center mt-auto py-8"><p className="text-sm text-gray-500">AI.me Pair Director by Wolfe.BT@TangentLLC</p></footer> );

            return (
                <div className="flex flex-col h-screen">
                    <div className="flex-shrink-0 z-20">
                       <div className="container mx-auto max-w-screen-xl px-4 sm:px-6 lg:px-8">
                            <Header />
                            <MainTabs activeTab={activeMainTab} setActiveTab={setActiveMainTab} />
                        </div>
                    </div>
                    
                    <div className="flex-grow overflow-y-auto">
                        <div className="container mx-auto max-w-screen-xl p-4 sm:p-6 lg:p-8">
                            <main>
                                {activeMainTab === 'video' && <div className="glass-panel p-6"><VideoVisuals setNotification={setNotification} /></div>}
                                {activeMainTab === 'audio' && <AudioView setNotification={setNotification} />}
                            </main>
                            <Footer />
                        </div>
                    </div>

                    <Notification notification={notification} onClear={clearNotification} />
                </div>
            );
        }

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
